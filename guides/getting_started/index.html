
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentación para el desarrollador backend del proyecto AgroInSight">
      
      
      
      
        <link rel="prev" href="../installation/">
      
      
        <link rel="next" href="../useful_tools/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Guía de inicio rápido - AgroInsight Backend Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#guia-de-inicio-rapido-para-desarrolladores-backend-de-agroinsight" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AgroInsight Backend Documentation" class="md-header__button md-logo" aria-label="AgroInsight Backend Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AgroInsight Backend Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Guía de inicio rápido
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AgroInsight Backend Documentation" class="md-nav__button md-logo" aria-label="AgroInsight Backend Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AgroInsight Backend Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Documentación complementaria
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Documentación complementaria
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../complement-docs/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://agroinsight-backend-production.up.railway.app/docs" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FastAPI Swagger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://agroinsight-backend-production.up.railway.app/redoc" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReDoc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://dbdocs.io/davidvalencia0526/AgroInsight" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.figma.com/design/PwBFnVysZISNgO8UIoOHL1/Agroinsight?node-id=0-1&node-type=CANVAS&t=s9L7qvi4CEiMX9ad-0" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diseño de interfaz UI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/DavidValenciaX/agroinsight-backend" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repositorio backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/Alejandroo04/AgroInsight_Front" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repositorio frontend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://usco-team-y6acsy2v.atlassian.net/jira/software/projects/AGROINSHT/boards/1/backlog" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jira
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://drive.google.com/drive/folders/1Nt50sTun-_FQMulYEXsy5aUcIJ7TXKpZ" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sharepoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://join.slack.com/t/agroinsight/shared_invite/zt-2rnhell7b-3~ziopW1zaod0ZD8QP6QFw" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guías
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Guías
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instalación
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Guía de inicio rápido
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Guía de inicio rápido
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estructura-del-proyecto" class="md-nav__link">
    <span class="md-ellipsis">
      Estructura del Proyecto
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Estructura del Proyecto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#estructura-de-un-modulo" class="md-nav__link">
    <span class="md-ellipsis">
      Estructura de un Módulo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infraestructura-comun" class="md-nav__link">
    <span class="md-ellipsis">
      Infraestructura Común
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#principios-de-desarrollo" class="md-nav__link">
    <span class="md-ellipsis">
      Principios de Desarrollo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Principios de Desarrollo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clean-code-y-arquitectura-limpia" class="md-nav__link">
    <span class="md-ellipsis">
      Clean Code y Arquitectura Limpia
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convenciones-de-codigo" class="md-nav__link">
    <span class="md-ellipsis">
      Convenciones de Código
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practicas-de-codificacion" class="md-nav__link">
    <span class="md-ellipsis">
      Prácticas de Codificación
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flujo-de-trabajo-de-desarrollo" class="md-nav__link">
    <span class="md-ellipsis">
      Flujo de Trabajo de Desarrollo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trabajando-con-la-base-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Trabajando con la Base de Datos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integracion-con-servicios-externos" class="md-nav__link">
    <span class="md-ellipsis">
      Integración con Servicios Externos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pruebas" class="md-nav__link">
    <span class="md-ellipsis">
      Pruebas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentacion" class="md-nav__link">
    <span class="md-ellipsis">
      Documentación
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#despliegue" class="md-nav__link">
    <span class="md-ellipsis">
      Despliegue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo-de-creacion-de-un-nuevo-modulo" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo de Creación de un Nuevo Módulo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejemplo de Creación de un Nuevo Módulo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-estructura-del-modulo" class="md-nav__link">
    <span class="md-ellipsis">
      1. Estructura del Módulo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-definicion-de-esquemas-domainschemaspy" class="md-nav__link">
    <span class="md-ellipsis">
      2. Definición de Esquemas (domain/schemas.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-definicion-de-modelos-orm-infrastructureorm_modelspy" class="md-nav__link">
    <span class="md-ellipsis">
      3. Definición de Modelos ORM (infrastructure/orm_models.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-implementacion-del-repositorio-infrastructuresql_repositorypy" class="md-nav__link">
    <span class="md-ellipsis">
      4. Implementación del Repositorio (infrastructure/sql_repository.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-implementacion-del-caso-de-uso-applicationcreate_soil_analysis_use_casepy" class="md-nav__link">
    <span class="md-ellipsis">
      5. Implementación del Caso de Uso (application/create_soil_analysis_use_case.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-definicion-de-la-api-infrastructureapipy" class="md-nav__link">
    <span class="md-ellipsis">
      6. Definición de la API (infrastructure/api.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-integracion-con-el-sistema-principal-mainpy" class="md-nav__link">
    <span class="md-ellipsis">
      7. Integración con el Sistema Principal (main.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uso-de-servicios-comunes" class="md-nav__link">
    <span class="md-ellipsis">
      Uso de Servicios Comunes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursos-adicionales" class="md-nav__link">
    <span class="md-ellipsis">
      Recursos Adicionales
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#soporte" class="md-nav__link">
    <span class="md-ellipsis">
      Soporte
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../useful_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía de herramientas útiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preguntas frecuentes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de usuarios
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Módulo de usuarios
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Esquemas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/repository/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repositorio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de Fincas
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Módulo de Fincas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../farm/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../farm/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../farm/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../farm/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de lotes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Módulo de lotes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de cultivos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Módulo de cultivos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crop/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crop/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crop/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crop/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de labores culturales
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Módulo de labores culturales
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cultural_practices/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cultural_practices/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cultural_practices/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cultural_practices/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de costos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Módulo de costos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../costs/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../costs/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../costs/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../costs/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Desarrollo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Desarrollo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía para contribuir al proyecto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/coding_standards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estándares de codificación
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acerca de
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estructura-del-proyecto" class="md-nav__link">
    <span class="md-ellipsis">
      Estructura del Proyecto
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Estructura del Proyecto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#estructura-de-un-modulo" class="md-nav__link">
    <span class="md-ellipsis">
      Estructura de un Módulo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infraestructura-comun" class="md-nav__link">
    <span class="md-ellipsis">
      Infraestructura Común
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#principios-de-desarrollo" class="md-nav__link">
    <span class="md-ellipsis">
      Principios de Desarrollo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Principios de Desarrollo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clean-code-y-arquitectura-limpia" class="md-nav__link">
    <span class="md-ellipsis">
      Clean Code y Arquitectura Limpia
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convenciones-de-codigo" class="md-nav__link">
    <span class="md-ellipsis">
      Convenciones de Código
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practicas-de-codificacion" class="md-nav__link">
    <span class="md-ellipsis">
      Prácticas de Codificación
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flujo-de-trabajo-de-desarrollo" class="md-nav__link">
    <span class="md-ellipsis">
      Flujo de Trabajo de Desarrollo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trabajando-con-la-base-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Trabajando con la Base de Datos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integracion-con-servicios-externos" class="md-nav__link">
    <span class="md-ellipsis">
      Integración con Servicios Externos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pruebas" class="md-nav__link">
    <span class="md-ellipsis">
      Pruebas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentacion" class="md-nav__link">
    <span class="md-ellipsis">
      Documentación
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#despliegue" class="md-nav__link">
    <span class="md-ellipsis">
      Despliegue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo-de-creacion-de-un-nuevo-modulo" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo de Creación de un Nuevo Módulo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ejemplo de Creación de un Nuevo Módulo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-estructura-del-modulo" class="md-nav__link">
    <span class="md-ellipsis">
      1. Estructura del Módulo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-definicion-de-esquemas-domainschemaspy" class="md-nav__link">
    <span class="md-ellipsis">
      2. Definición de Esquemas (domain/schemas.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-definicion-de-modelos-orm-infrastructureorm_modelspy" class="md-nav__link">
    <span class="md-ellipsis">
      3. Definición de Modelos ORM (infrastructure/orm_models.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-implementacion-del-repositorio-infrastructuresql_repositorypy" class="md-nav__link">
    <span class="md-ellipsis">
      4. Implementación del Repositorio (infrastructure/sql_repository.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-implementacion-del-caso-de-uso-applicationcreate_soil_analysis_use_casepy" class="md-nav__link">
    <span class="md-ellipsis">
      5. Implementación del Caso de Uso (application/create_soil_analysis_use_case.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-definicion-de-la-api-infrastructureapipy" class="md-nav__link">
    <span class="md-ellipsis">
      6. Definición de la API (infrastructure/api.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-integracion-con-el-sistema-principal-mainpy" class="md-nav__link">
    <span class="md-ellipsis">
      7. Integración con el Sistema Principal (main.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uso-de-servicios-comunes" class="md-nav__link">
    <span class="md-ellipsis">
      Uso de Servicios Comunes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursos-adicionales" class="md-nav__link">
    <span class="md-ellipsis">
      Recursos Adicionales
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#soporte" class="md-nav__link">
    <span class="md-ellipsis">
      Soporte
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="guia-de-inicio-rapido-para-desarrolladores-backend-de-agroinsight">Guía de Inicio Rápido para Desarrolladores Backend de AgroInsight</h1>
<h2 id="introduccion">Introducción</h2>
<p>Bienvenido al equipo de desarrollo backend de AgroInsight. Esta guía te proporcionará la información necesaria para comenzar a contribuir al proyecto. AgroInsight es una aplicación de gestión agrícola diseñada para optimizar el cultivo de maíz en la región del Huila, Colombia, utilizando tecnologías modernas y prácticas de desarrollo ágil.</p>
<h2 id="estructura-del-proyecto">Estructura del Proyecto</h2>
<p>El proyecto sigue una arquitectura limpia y está organizado en módulos, cada uno con sus propias capas. La estructura general es la siguiente:</p>
<div class="highlight"><pre><span></span><code>app/
├── [nombre_del_modulo]/
│   ├── application/
│   ├── domain/
│   └── infrastructure/
├── infrastructure/
│   ├── common/
│   ├── database/
│   ├── security/
│   └── services/
└── main.py
</code></pre></div>
<h3 id="estructura-de-un-modulo">Estructura de un Módulo</h3>
<p>Cuando se desarrolla un nuevo módulo, se debe crear una carpeta con el nombre del módulo dentro de <code>app/</code> y dentro de ella las siguientes subcarpetas y archivos:</p>
<ul>
<li><code>application/</code>: Contiene los casos de uso (archivos <code>*_use_case.py</code>).</li>
<li><code>domain/</code>: Define las entidades y reglas de negocio.</li>
<li><code>schemas.py</code>: Define los esquemas Pydantic del módulo.</li>
<li><code>infrastructure/</code>:</li>
<li><code>api.py</code>: Define los endpoints del módulo.</li>
<li><code>sql_repository.py</code>: Contiene las transacciones de la base de datos.</li>
<li><code>orm_models.py</code>: Define los modelos ORM del módulo.</li>
</ul>
<h3 id="infraestructura-comun">Infraestructura Común</h3>
<p>La carpeta <code>app/infrastructure</code> contiene archivos comunes a todo el proyecto, incluyendo:</p>
<ul>
<li>Conexión a la base de datos</li>
<li>Middleware JWT</li>
<li>Servicios para envío de emails</li>
<li>Servicios para generación de PINs de seguridad</li>
<li>Servicios de encriptación de contraseñas</li>
<li>Servicios de generación de tokens de acceso</li>
<li>Validadores</li>
<li>Response mappers</li>
<li>Importaciones de variables de entorno</li>
<li>Errores personalizados</li>
<li>Manejadores de errores</li>
<li>Código común utilizado en todos los módulos</li>
</ul>
<h2 id="principios-de-desarrollo">Principios de Desarrollo</h2>
<h3 id="clean-code-y-arquitectura-limpia">Clean Code y Arquitectura Limpia</h3>
<p>El proyecto AgroInsight sigue los principios de Clean Code y Arquitectura Limpia. Esto implica:</p>
<ol>
<li>Separación clara de responsabilidades entre capas.</li>
<li>Dependencias apuntando hacia el dominio.</li>
<li>Entidades de negocio independientes de frameworks y detalles de implementación.</li>
<li>Casos de uso que encapsulan la lógica de la aplicación.</li>
</ol>
<h3 id="convenciones-de-codigo">Convenciones de Código</h3>
<ul>
<li>Seguimos la guía de estilo PEP 8 para Python.</li>
<li>Utilizamos Type Hints para anotaciones de tipo.</li>
<li>Documentamos las funciones y clases utilizando docstrings en formato Google.</li>
<li>Utilizamos Black para el formateo automático del código.</li>
<li>Empleamos Flake8 para el linting del código.</li>
</ul>
<h3 id="practicas-de-codificacion">Prácticas de Codificación</h3>
<ol>
<li>
<p><strong>Early Return</strong>: Preferimos el estilo de "early return" para mejorar la legibilidad y reducir la anidación.</p>
</li>
<li>
<p><strong>DRY (Don't Repeat Yourself)</strong>: Si notas que estás repitiendo el mismo código en múltiples lugares, refactoriza ese código en una función o método reutilizable.</p>
</li>
<li>
<p><strong>Estructura del Proyecto</strong>: Al desarrollar o refactorizar una funcionalidad de un módulo existente, sigue la estructura ya definida para mantener la consistencia.</p>
</li>
<li>
<p><strong>Nombres Descriptivos</strong>: Usa nombres claros y significativos para variables, funciones y clases.</p>
</li>
<li>
<p><strong>Funciones Pequeñas</strong>: Las funciones deben ser cortas y hacer una sola cosa.</p>
</li>
<li>
<p><strong>Comentarios Útiles</strong>: Los comentarios deben explicar el "por qué", no el "qué". El código debe ser autoexplicativo.</p>
</li>
<li>
<p><strong>Manejo de Errores</strong>: Implementa un manejo de errores personalizado para la lógica de negocio, la validación de datos de entrada y los errores inesperados. Los mensajes deben ser claros y consistente.</p>
</li>
</ol>
<h2 id="flujo-de-trabajo-de-desarrollo">Flujo de Trabajo de Desarrollo</h2>
<ol>
<li>Crea una nueva rama para tu feature o bugfix:</li>
</ol>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature/nombre-de-la-caracteristica
</code></pre></div>
<ol>
<li>
<p>Desarrolla tu código siguiendo las convenciones y principios establecidos.</p>
</li>
<li>
<p>Ejecuta las pruebas unitarias y asegúrate de que pasen:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code>pytest
</code></pre></div>
<ol>
<li>Formatea tu código:</li>
</ol>
<div class="highlight"><pre><span></span><code>black<span class="w"> </span>.
</code></pre></div>
<ol>
<li>Ejecuta el linter:</li>
</ol>
<div class="highlight"><pre><span></span><code>flake8
</code></pre></div>
<ol>
<li>Realiza un commit de tus cambios:</li>
</ol>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Descripción concisa de los cambios&quot;</span>
</code></pre></div>
<ol>
<li>Sube tus cambios a GitHub:</li>
</ol>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>feature/nombre-de-la-caracteristica
</code></pre></div>
<ol>
<li>Crea un Pull Request en GitHub para revisión.</li>
</ol>
<h2 id="trabajando-con-la-base-de-datos">Trabajando con la Base de Datos</h2>
<p>AgroInsight utiliza Postgresql 16.2 como sistema de gestión de base de datos. La estructura de la base de datos se administra a través de PgAdmin utilizando lenguaje SQL. La estructura está documentada en <a href="https://dbdocs.io/davidvalencia0526/AgroInsight">https://dbdocs.io/davidvalencia0526/AgroInsight</a>.</p>
<h2 id="integracion-con-servicios-externos">Integración con Servicios Externos</h2>
<p>AgroInsight integra varios servicios externos. Asegúrate de tener las credenciales necesarias en tu archivo <code>.env</code>:</p>
<ul>
<li>API de OpenWeatherMap para datos meteorológicos</li>
<li>Servicio de correo electrónico (SMTP) para notificaciones</li>
<li>Servicios de almacenamiento en la nube para imágenes y archivos</li>
</ul>
<h2 id="pruebas">Pruebas</h2>
<p>Ejecutamos pruebas unitarias, de integración y end-to-end. Para ejecutar todas las pruebas:</p>
<div class="highlight"><pre><span></span><code>pytest
</code></pre></div>
<p>Para ejecutar pruebas específicas:</p>
<div class="highlight"><pre><span></span><code>pytest<span class="w"> </span>tests/unit
pytest<span class="w"> </span>tests/integration
pytest<span class="w"> </span>tests/e2e
</code></pre></div>
<h2 id="documentacion">Documentación</h2>
<p>La documentación del API se genera automáticamente y está disponible en:</p>
<ul>
<li>Swagger UI: <code>http://localhost:8000/docs</code></li>
<li>ReDoc: <code>http://localhost:8000/redoc</code></li>
</ul>
<p>Para generar la documentación del proyecto:</p>
<div class="highlight"><pre><span></span><code>mkdocs<span class="w"> </span>serve
</code></pre></div>
<p>Esto iniciará un servidor local con la documentación en <code>http://localhost:8000</code>.</p>
<h2 id="despliegue">Despliegue</h2>
<p>El despliegue se realiza automáticamente a través de Railway cuando se fusiona código en la rama <code>main</code>. Asegúrate de que todas las pruebas pasen antes de fusionar tus cambios.</p>
<h2 id="ejemplo-de-creacion-de-un-nuevo-modulo">Ejemplo de Creación de un Nuevo Módulo</h2>
<p>Para ilustrar cómo crear un nuevo módulo en AgroInsight, vamos a desarrollar un módulo de "Análisis de Suelo". Este módulo permitirá a los usuarios registrar y consultar análisis de suelo para sus lotes.</p>
<h3 id="1-estructura-del-modulo">1. Estructura del Módulo</h3>
<p>Primero, creamos la estructura de carpetas para el nuevo módulo:</p>
<div class="highlight"><pre><span></span><code>app/
└── soil_analysis/
    ├── application/
    │   └── __init__.py
    ├── domain/
    │   ├── __init__.py
    │   └── schemas.py
    └── infrastructure/
        ├── __init__.py
        ├── api.py
        ├── orm_models.py
        └── sql_repository.py
</code></pre></div>
<h3 id="2-definicion-de-esquemas-domainschemaspy">2. Definición de Esquemas (domain/schemas.py)</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="k">class</span> <span class="nc">SoilAnalysisBase</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">lote_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">fecha_analisis</span><span class="p">:</span> <span class="n">date</span>
    <span class="n">ph</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">materia_organica</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">nitrogeno</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fosforo</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">potasio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">observaciones</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">class</span> <span class="nc">SoilAnalysisCreate</span><span class="p">(</span><span class="n">SoilAnalysisBase</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">SoilAnalysisResponse</span><span class="p">(</span><span class="n">SoilAnalysisBase</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">from_attributes</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
<h3 id="3-definicion-de-modelos-orm-infrastructureorm_modelspy">3. Definición de Modelos ORM (infrastructure/orm_models.py)</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Float</span><span class="p">,</span> <span class="n">Date</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">,</span> <span class="n">Text</span>
<span class="kn">from</span> <span class="nn">app.infrastructure.database.database</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="k">class</span> <span class="nc">SoilAnalysis</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;analisis_suelo&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lote_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;lote.id&quot;</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">fecha_analisis</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">materia_organica</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">nitrogeno</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">fosforo</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">potasio</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">observaciones</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
</code></pre></div>
<h3 id="4-implementacion-del-repositorio-infrastructuresql_repositorypy">4. Implementación del Repositorio (infrastructure/sql_repository.py)</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">app.soil_analysis.infrastructure.orm_models</span> <span class="kn">import</span> <span class="n">SoilAnalysis</span>
<span class="kn">from</span> <span class="nn">app.soil_analysis.domain.schemas</span> <span class="kn">import</span> <span class="n">SoilAnalysisCreate</span>

<span class="k">class</span> <span class="nc">SoilAnalysisRepository</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>

    <span class="k">def</span> <span class="nf">create_soil_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">soil_analysis</span><span class="p">:</span> <span class="n">SoilAnalysisCreate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SoilAnalysis</span><span class="p">:</span>
        <span class="n">db_soil_analysis</span> <span class="o">=</span> <span class="n">SoilAnalysis</span><span class="p">(</span><span class="o">**</span><span class="n">soil_analysis</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">db_soil_analysis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">db_soil_analysis</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">db_soil_analysis</span>

    <span class="k">def</span> <span class="nf">get_soil_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">soil_analysis_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SoilAnalysis</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">SoilAnalysis</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">SoilAnalysis</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">soil_analysis_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_soil_analyses_by_lote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lote_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">SoilAnalysis</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">SoilAnalysis</span><span class="o">.</span><span class="n">lote_id</span> <span class="o">==</span> <span class="n">lote_id</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div>
<h3 id="5-implementacion-del-caso-de-uso-applicationcreate_soil_analysis_use_casepy">5. Implementación del Caso de Uso (application/create_soil_analysis_use_case.py)</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">app.soil_analysis.infrastructure.sql_repository</span> <span class="kn">import</span> <span class="n">SoilAnalysisRepository</span>
<span class="kn">from</span> <span class="nn">app.soil_analysis.domain.schemas</span> <span class="kn">import</span> <span class="n">SoilAnalysisCreate</span><span class="p">,</span> <span class="n">SoilAnalysisResponse</span>
<span class="kn">from</span> <span class="nn">app.infrastructure.common.common_exceptions</span> <span class="kn">import</span> <span class="n">DomainException</span>
<span class="kn">from</span> <span class="nn">app.user.domain.schemas</span> <span class="kn">import</span> <span class="n">UserInDB</span>
<span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">status</span>

<span class="k">class</span> <span class="nc">CreateSoilAnalysisUseCase</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soil_analysis_repository</span> <span class="o">=</span> <span class="n">SoilAnalysisRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">soil_analysis_data</span><span class="p">:</span> <span class="n">SoilAnalysisCreate</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SoilAnalysisResponse</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_can_create_soil_analysis</span><span class="p">(</span><span class="n">current_user</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para crear un análisis de suelo.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
            <span class="p">)</span>

        <span class="c1"># Aquí podrías agregar más validaciones, como verificar si el lote existe y pertenece al usuario</span>

        <span class="n">soil_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">soil_analysis_repository</span><span class="o">.</span><span class="n">create_soil_analysis</span><span class="p">(</span><span class="n">soil_analysis_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SoilAnalysisResponse</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">soil_analysis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">user_can_create_soil_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">allowed_roles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Administrador de Finca&quot;</span><span class="p">,</span> <span class="s2">&quot;Agrónomo&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">nombre</span> <span class="ow">in</span> <span class="n">allowed_roles</span> <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">user</span><span class="o">.</span><span class="n">roles</span><span class="p">)</span>
</code></pre></div>
<h3 id="6-definicion-de-la-api-infrastructureapipy">6. Definición de la API (infrastructure/api.py)</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">APIRouter</span><span class="p">,</span> <span class="n">Depends</span><span class="p">,</span> <span class="n">HTTPException</span><span class="p">,</span> <span class="n">status</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">app.infrastructure.database.database</span> <span class="kn">import</span> <span class="n">getDb</span>
<span class="kn">from</span> <span class="nn">app.soil_analysis.domain.schemas</span> <span class="kn">import</span> <span class="n">SoilAnalysisCreate</span><span class="p">,</span> <span class="n">SoilAnalysisResponse</span>
<span class="kn">from</span> <span class="nn">app.soil_analysis.application.create_soil_analysis_use_case</span> <span class="kn">import</span> <span class="n">CreateSoilAnalysisUseCase</span>
<span class="kn">from</span> <span class="nn">app.infrastructure.security.security_utils</span> <span class="kn">import</span> <span class="n">get_current_user</span>
<span class="kn">from</span> <span class="nn">app.user.domain.schemas</span> <span class="kn">import</span> <span class="n">UserInDB</span>

<span class="n">router</span> <span class="o">=</span> <span class="n">APIRouter</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;/soil-analysis&quot;</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Soil Analysis&quot;</span><span class="p">])</span>

<span class="nd">@router</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">SoilAnalysisResponse</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_soil_analysis</span><span class="p">(</span>
    <span class="n">soil_analysis</span><span class="p">:</span> <span class="n">SoilAnalysisCreate</span><span class="p">,</span>
    <span class="n">db</span><span class="p">:</span> <span class="n">Session</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">getDb</span><span class="p">),</span>
    <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span> <span class="o">=</span> <span class="n">Depends</span><span class="p">(</span><span class="n">get_current_user</span><span class="p">)</span>
<span class="p">):</span>
    <span class="n">use_case</span> <span class="o">=</span> <span class="n">CreateSoilAnalysisUseCase</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">use_case</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">soil_analysis</span><span class="p">,</span> <span class="n">current_user</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span><span class="p">,</span> 
            <span class="n">detail</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error interneo al crear el análisis de suelo: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
</code></pre></div>
<h3 id="7-integracion-con-el-sistema-principal-mainpy">7. Integración con el Sistema Principal (main.py)</h3>
<p>Finalmente, incluimos el router del nuevo módulo en el archivo principal de la aplicación:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
<span class="kn">from</span> <span class="nn">app.soil_analysis.infrastructure.api</span> <span class="kn">import</span> <span class="n">router</span> <span class="k">as</span> <span class="n">soil_analysis_router</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="c1"># ... otros imports y configuraciones ...</span>

<span class="n">app</span><span class="o">.</span><span class="n">include_router</span><span class="p">(</span><span class="n">soil_analysis_router</span><span class="p">)</span>
</code></pre></div>
<h3 id="uso-de-servicios-comunes">Uso de Servicios Comunes</h3>
<p>En este ejemplo, hemos utilizado varios servicios y componentes comunes del proyecto:</p>
<ol>
<li><strong>Base de datos</strong>: Utilizamos la sesión de base de datos proporcionada por <code>getDb()</code>.</li>
<li><strong>Autenticación</strong>: Usamos <code>get_current_user()</code> para obtener el usuario autenticado.</li>
<li><strong>Manejo de excepciones</strong>: Empleamos <code>DomainException</code> para errores de dominio personalizados.</li>
<li><strong>Modelos ORM</strong>: Extendemos <code>Base</code> de SQLAlchemy para nuestro modelo ORM.</li>
<li><strong>Validación de datos</strong>: Utilizamos Pydantic para la validación de datos de entrada y salida.</li>
</ol>
<h2 id="recursos-adicionales">Recursos Adicionales</h2>
<ul>
<li><a href="https://fastapi.tiangolo.com/">Documentación oficial de FastAPI</a></li>
<li><a href="https://docs.sqlalchemy.org/">Documentación de SQLAlchemy</a></li>
<li><a href="https://docs.railway.app/">Guía de Railway para despliegue</a></li>
<li><a href="https://www.tensorflow.org/api_docs">Documentación de TensorFlow</a></li>
</ul>
<h2 id="soporte">Soporte</h2>
<p>Si encuentras algún problema o tienes preguntas, no dudes en contactar al equipo de desarrollo a través del canal #backend-support en Slack.</p>
<p>¡Bienvenido al equipo y feliz codificación!</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>