
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentación para el desarrollador backend del proyecto AgroInSight">
      
      
      
      
        <link rel="prev" href="../models/">
      
      
        <link rel="next" href="../../development/contributing/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Casos de uso - AgroInsight Backend Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#casos-de-uso-del-modulo-de-practicas-culturales" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AgroInsight Backend Documentation" class="md-header__button md-logo" aria-label="AgroInsight Backend Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AgroInsight Backend Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Casos de uso
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AgroInsight Backend Documentation" class="md-nav__button md-logo" aria-label="AgroInsight Backend Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AgroInsight Backend Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Documentación complementaria
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Documentación complementaria
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../complement-docs/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://agroinsight-backend-production.up.railway.app/docs" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FastAPI Swagger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://agroinsight-backend-production.up.railway.app/redoc" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReDoc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://dbdocs.io/davidvalencia0526/AgroInsight" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.figma.com/design/PwBFnVysZISNgO8UIoOHL1/Agroinsight?node-id=0-1&node-type=CANVAS&t=s9L7qvi4CEiMX9ad-0" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diseño de interfaz UI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/DavidValenciaX/agroinsight-backend" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repositorio backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/Alejandroo04/AgroInsight_Front" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repositorio frontend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://usco-team-y6acsy2v.atlassian.net/jira/software/projects/AGROINSHT/boards/1/backlog" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jira
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://drive.google.com/drive/folders/1Nt50sTun-_FQMulYEXsy5aUcIJ7TXKpZ" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sharepoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://join.slack.com/t/agroinsight/shared_invite/zt-2rnhell7b-3~ziopW1zaod0ZD8QP6QFw" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guías
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Guías
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instalación
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía de inicio rápido
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/useful_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía de herramientas útiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preguntas frecuentes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de usuarios
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Módulo de usuarios
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Esquemas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/repository/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repositorio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de Fincas
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Módulo de Fincas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../farm/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../farm/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../farm/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../farm/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de lotes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Módulo de lotes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de cultivos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Módulo de cultivos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crop/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crop/endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crop/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crop/use_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Módulo de labores culturales
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Módulo de labores culturales
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descripción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../endpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelos de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Casos de uso
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#asignar-tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Asignar Tarea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      AssignTaskUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.create_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      create_assignment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cambiar-estado-de-tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Cambiar Estado de Tarea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      ChangeTaskStateUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.change_task_state" class="md-nav__link">
    <span class="md-ellipsis">
      change_task_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.user_can_change_task_state" class="md-nav__link">
    <span class="md-ellipsis">
      user_can_change_task_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crear-tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Crear Tarea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.create_task_use_case.CreateTaskUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      CreateTaskUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.create_task" class="md-nav__link">
    <span class="md-ellipsis">
      create_task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#obtener-tarea-por-id" class="md-nav__link">
    <span class="md-ellipsis">
      Obtener Tarea por ID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      GetTaskByIdUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.get_task_by_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_task_by_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listar-tareas-por-usuario-y-finca" class="md-nav__link">
    <span class="md-ellipsis">
      Listar Tareas por Usuario y Finca
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      ListTasksByUserAndFarmUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.list_tasks_by_user_and_farm" class="md-nav__link">
    <span class="md-ellipsis">
      list_tasks_by_user_and_farm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listar-estados-de-tareas" class="md-nav__link">
    <span class="md-ellipsis">
      Listar Estados de Tareas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      ListTaskStatesUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase.list_task_states" class="md-nav__link">
    <span class="md-ellipsis">
      list_task_states
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listar-tipos-de-tareas" class="md-nav__link">
    <span class="md-ellipsis">
      Listar Tipos de Tareas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      ListTaskTypesUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase.list_task_types" class="md-nav__link">
    <span class="md-ellipsis">
      list_task_types
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Desarrollo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Desarrollo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía para contribuir al proyecto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/coding_standards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estándares de codificación
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acerca de
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#asignar-tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Asignar Tarea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      AssignTaskUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.create_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      create_assignment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cambiar-estado-de-tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Cambiar Estado de Tarea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      ChangeTaskStateUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.change_task_state" class="md-nav__link">
    <span class="md-ellipsis">
      change_task_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.user_can_change_task_state" class="md-nav__link">
    <span class="md-ellipsis">
      user_can_change_task_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crear-tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Crear Tarea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.create_task_use_case.CreateTaskUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      CreateTaskUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.create_task" class="md-nav__link">
    <span class="md-ellipsis">
      create_task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#obtener-tarea-por-id" class="md-nav__link">
    <span class="md-ellipsis">
      Obtener Tarea por ID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      GetTaskByIdUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.get_task_by_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_task_by_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listar-tareas-por-usuario-y-finca" class="md-nav__link">
    <span class="md-ellipsis">
      Listar Tareas por Usuario y Finca
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      ListTasksByUserAndFarmUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.list_tasks_by_user_and_farm" class="md-nav__link">
    <span class="md-ellipsis">
      list_tasks_by_user_and_farm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listar-estados-de-tareas" class="md-nav__link">
    <span class="md-ellipsis">
      Listar Estados de Tareas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      ListTaskStatesUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase.list_task_states" class="md-nav__link">
    <span class="md-ellipsis">
      list_task_states
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listar-tipos-de-tareas" class="md-nav__link">
    <span class="md-ellipsis">
      Listar Tipos de Tareas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase" class="md-nav__link">
    <span class="md-ellipsis">
      ListTaskTypesUseCase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase.list_task_types" class="md-nav__link">
    <span class="md-ellipsis">
      list_task_types
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="casos-de-uso-del-modulo-de-practicas-culturales">Casos de Uso del Módulo de Prácticas Culturales</h1>
<h2 id="asignar-tarea">Asignar Tarea</h2>


<div class="doc doc-object doc-class">



<a id="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase"></a>
    <div class="doc doc-contents first">


        <p>Caso de uso para asignar tareas de labor cultural a usuarios.</p>
<p>Este caso de uso gestiona la lógica de negocio para la creación de asignaciones de tareas,
asegurando que se cumplan las validaciones necesarias antes de realizar la asignación.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.db">db</span></code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.cultural_practice_repository">cultural_practice_repository</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.infrastructure.sql_repository.CulturalPracticesRepository">CulturalPracticesRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de prácticas culturales.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.user_repository">user_repository</span></code></td>
            <td>
                  <code><span title="app.user.infrastructure.sql_repository.UserRepository">UserRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de usuarios.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.plot_repository">plot_repository</span></code></td>
            <td>
                  <code><span title="app.plot.infrastructure.sql_repository.PlotRepository">PlotRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de lotes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.farm_repository">farm_repository</span></code></td>
            <td>
                  <code><span title="app.farm.infrastructure.sql_repository.FarmRepository">FarmRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de fincas.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.farm_service">farm_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.farm.application.services.farm_service.FarmService" href="../../farm/use_cases/#app.farm.application.services.farm_service.FarmService">FarmService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Servicio para lógica de negocio de fincas.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>app\cultural_practices\application\assign_task_use_case.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AssignTaskUseCase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Caso de uso para asignar tareas de labor cultural a usuarios.</span>

<span class="sd">    Este caso de uso gestiona la lógica de negocio para la creación de asignaciones de tareas,</span>
<span class="sd">    asegurando que se cumplan las validaciones necesarias antes de realizar la asignación.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        cultural_practice_repository (CulturalPracticesRepository): Repositorio para operaciones de prácticas culturales.</span>
<span class="sd">        user_repository (UserRepository): Repositorio para operaciones de usuarios.</span>
<span class="sd">        plot_repository (PlotRepository): Repositorio para operaciones de lotes.</span>
<span class="sd">        farm_repository (FarmRepository): Repositorio para operaciones de fincas.</span>
<span class="sd">        farm_service (FarmService): Servicio para lógica de negocio de fincas.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">        Args:</span>
<span class="sd">            db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span> <span class="o">=</span> <span class="n">UserRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span> <span class="o">=</span> <span class="n">PlotRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span> <span class="o">=</span> <span class="n">FarmRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assignment_data</span><span class="p">:</span> <span class="n">AssignmentCreate</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultipleResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Crea asignaciones de tareas para los usuarios especificados.</span>

<span class="sd">        Este método valida la existencia de la tarea, el lote y la finca, así como los permisos del usuario</span>
<span class="sd">        que intenta realizar la asignación. Luego, itera sobre los IDs de los usuarios y crea las asignaciones</span>
<span class="sd">        correspondientes, registrando los mensajes de éxito o error.</span>

<span class="sd">        Args:</span>
<span class="sd">            assignment_data (AssignmentCreate): Datos de la asignación a crear.</span>
<span class="sd">            current_user (UserInDB): Usuario actual autenticado que intenta realizar la asignación.</span>

<span class="sd">        Returns:</span>
<span class="sd">            MultipleResponse: Respuesta que incluye mensajes sobre el resultado de las asignaciones y el código de estado.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DomainException: Si la tarea, lote o finca no existen, o si el usuario no tiene permisos.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validar que la tarea existe</span>
        <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">assignment_data</span><span class="o">.</span><span class="n">tarea_labor_cultural_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la tarea.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Obtener lote por ID</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span><span class="o">.</span><span class="n">get_plot_by_id</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">lote_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plot</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el lote.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Obtener finca por ID</span>
        <span class="n">farm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span><span class="o">.</span><span class="n">get_farm_by_id</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">finca_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">farm</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la finca.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Validar que el usuario sea administrador de la finca</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">farm</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para asignar tareas en esta finca.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
            <span class="p">)</span>

        <span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">success_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">failure_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Iterar sobre cada usuario_id en usuario_ids</span>
        <span class="k">for</span> <span class="n">usuario_id</span> <span class="ow">in</span> <span class="n">assignment_data</span><span class="o">.</span><span class="n">usuario_ids</span><span class="p">:</span>
            <span class="c1"># Obtener el nombre del usuario</span>
            <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span><span class="o">.</span><span class="n">get_user_by_id</span><span class="p">(</span><span class="n">usuario_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El usuario con ID </span><span class="si">{</span><span class="n">usuario_id</span><span class="si">}</span><span class="s2"> especificado no existe.&quot;</span><span class="p">)</span>
                <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="n">user_name</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">nombre</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="n">apellido</span>

            <span class="k">if</span> <span class="n">current_user</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">usuario_id</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2"> es el administrador de la finca.&quot;</span><span class="p">)</span>
                <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="c1"># Validar que el usuario es trabajador de la finca</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_worker</span><span class="p">(</span><span class="n">usuario_id</span><span class="p">,</span> <span class="n">farm</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2"> no es trabajador de la finca.&quot;</span><span class="p">)</span>
                <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="c1"># Validar que el usuario no tenga ya asignada esa tarea</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_user_task_assignment</span><span class="p">(</span><span class="n">usuario_id</span><span class="p">,</span> <span class="n">assignment_data</span><span class="o">.</span><span class="n">tarea_labor_cultural_id</span><span class="p">):</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2"> ya tiene asignada la tarea con ID </span><span class="si">{</span><span class="n">assignment_data</span><span class="o">.</span><span class="n">tarea_labor_cultural_id</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="n">assignment_data_single</span> <span class="o">=</span> <span class="n">AssignmentCreateSingle</span><span class="p">(</span>
                <span class="n">usuario_id</span><span class="o">=</span><span class="n">usuario_id</span><span class="p">,</span>
                <span class="n">tarea_labor_cultural_id</span><span class="o">=</span><span class="n">assignment_data</span><span class="o">.</span><span class="n">tarea_labor_cultural_id</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">create_assignment</span><span class="p">(</span><span class="n">assignment_data_single</span><span class="p">):</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No se pudo crear la asignación para el usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Asignación creada exitosamente para el usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">success_count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">success_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">failure_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_207_MULTI_STATUS</span>
        <span class="k">elif</span> <span class="n">success_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_400_BAD_REQUEST</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span>

        <span class="k">return</span> <span class="n">MultipleResponse</span><span class="p">(</span><span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="n">status_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inicializa el caso de uso con las dependencias necesarias.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>db</code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\assign_task_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">    Args:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span> <span class="o">=</span> <span class="n">UserRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span> <span class="o">=</span> <span class="n">PlotRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span> <span class="o">=</span> <span class="n">FarmRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.assign_task_use_case.AssignTaskUseCase.create_assignment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_assignment</span><span class="p">(</span><span class="n">assignment_data</span><span class="p">,</span> <span class="n">current_user</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Crea asignaciones de tareas para los usuarios especificados.</p>
<p>Este método valida la existencia de la tarea, el lote y la finca, así como los permisos del usuario
que intenta realizar la asignación. Luego, itera sobre los IDs de los usuarios y crea las asignaciones
correspondientes, registrando los mensajes de éxito o error.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>assignment_data</code></td>
            <td>
                  <code><span title="app.cultural_practices.domain.schemas.AssignmentCreate">AssignmentCreate</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datos de la asignación a crear.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>current_user</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.user.domain.schemas.UserInDB" href="../../user/schemas/#app.user.domain.schemas.UserInDB">UserInDB</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Usuario actual autenticado que intenta realizar la asignación.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>MultipleResponse</code></td>            <td>
                  <code><span title="app.infrastructure.common.response_models.MultipleResponse">MultipleResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Respuesta que incluye mensajes sobre el resultado de las asignaciones y el código de estado.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="app.infrastructure.common.common_exceptions.DomainException">DomainException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Si la tarea, lote o finca no existen, o si el usuario no tiene permisos.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\assign_task_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assignment_data</span><span class="p">:</span> <span class="n">AssignmentCreate</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultipleResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Crea asignaciones de tareas para los usuarios especificados.</span>

<span class="sd">    Este método valida la existencia de la tarea, el lote y la finca, así como los permisos del usuario</span>
<span class="sd">    que intenta realizar la asignación. Luego, itera sobre los IDs de los usuarios y crea las asignaciones</span>
<span class="sd">    correspondientes, registrando los mensajes de éxito o error.</span>

<span class="sd">    Args:</span>
<span class="sd">        assignment_data (AssignmentCreate): Datos de la asignación a crear.</span>
<span class="sd">        current_user (UserInDB): Usuario actual autenticado que intenta realizar la asignación.</span>

<span class="sd">    Returns:</span>
<span class="sd">        MultipleResponse: Respuesta que incluye mensajes sobre el resultado de las asignaciones y el código de estado.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DomainException: Si la tarea, lote o finca no existen, o si el usuario no tiene permisos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validar que la tarea existe</span>
    <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">assignment_data</span><span class="o">.</span><span class="n">tarea_labor_cultural_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la tarea.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Obtener lote por ID</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span><span class="o">.</span><span class="n">get_plot_by_id</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">lote_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">plot</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el lote.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Obtener finca por ID</span>
    <span class="n">farm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span><span class="o">.</span><span class="n">get_farm_by_id</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">finca_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">farm</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la finca.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Validar que el usuario sea administrador de la finca</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">farm</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para asignar tareas en esta finca.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
        <span class="p">)</span>

    <span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">success_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">failure_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Iterar sobre cada usuario_id en usuario_ids</span>
    <span class="k">for</span> <span class="n">usuario_id</span> <span class="ow">in</span> <span class="n">assignment_data</span><span class="o">.</span><span class="n">usuario_ids</span><span class="p">:</span>
        <span class="c1"># Obtener el nombre del usuario</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span><span class="o">.</span><span class="n">get_user_by_id</span><span class="p">(</span><span class="n">usuario_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El usuario con ID </span><span class="si">{</span><span class="n">usuario_id</span><span class="si">}</span><span class="s2"> especificado no existe.&quot;</span><span class="p">)</span>
            <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="n">user_name</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">nombre</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="n">apellido</span>

        <span class="k">if</span> <span class="n">current_user</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">usuario_id</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2"> es el administrador de la finca.&quot;</span><span class="p">)</span>
            <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="c1"># Validar que el usuario es trabajador de la finca</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_worker</span><span class="p">(</span><span class="n">usuario_id</span><span class="p">,</span> <span class="n">farm</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2"> no es trabajador de la finca.&quot;</span><span class="p">)</span>
            <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="c1"># Validar que el usuario no tenga ya asignada esa tarea</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_user_task_assignment</span><span class="p">(</span><span class="n">usuario_id</span><span class="p">,</span> <span class="n">assignment_data</span><span class="o">.</span><span class="n">tarea_labor_cultural_id</span><span class="p">):</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2"> ya tiene asignada la tarea con ID </span><span class="si">{</span><span class="n">assignment_data</span><span class="o">.</span><span class="n">tarea_labor_cultural_id</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="n">assignment_data_single</span> <span class="o">=</span> <span class="n">AssignmentCreateSingle</span><span class="p">(</span>
            <span class="n">usuario_id</span><span class="o">=</span><span class="n">usuario_id</span><span class="p">,</span>
            <span class="n">tarea_labor_cultural_id</span><span class="o">=</span><span class="n">assignment_data</span><span class="o">.</span><span class="n">tarea_labor_cultural_id</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">create_assignment</span><span class="p">(</span><span class="n">assignment_data_single</span><span class="p">):</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No se pudo crear la asignación para el usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Asignación creada exitosamente para el usuario </span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">success_count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">success_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">failure_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">status_code</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_207_MULTI_STATUS</span>
    <span class="k">elif</span> <span class="n">success_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">status_code</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_400_BAD_REQUEST</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">status_code</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span>

    <span class="k">return</span> <span class="n">MultipleResponse</span><span class="p">(</span><span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="n">status_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="cambiar-estado-de-tarea">Cambiar Estado de Tarea</h2>


<div class="doc doc-object doc-class">



<a id="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase"></a>
    <div class="doc doc-contents first">


        <p>Caso de uso para cambiar el estado de una tarea de labor cultural.</p>
<p>Este caso de uso gestiona la lógica de negocio para cambiar el estado de una tarea,
asegurando que se cumplan las validaciones necesarias antes de realizar el cambio.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.db">db</span></code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.cultural_practice_repository">cultural_practice_repository</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.infrastructure.sql_repository.CulturalPracticesRepository">CulturalPracticesRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de prácticas culturales.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.plot_repository">plot_repository</span></code></td>
            <td>
                  <code><span title="app.plot.infrastructure.sql_repository.PlotRepository">PlotRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de lotes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.farm_repository">farm_repository</span></code></td>
            <td>
                  <code><span title="app.farm.infrastructure.sql_repository.FarmRepository">FarmRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de fincas.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.farm_service">farm_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.farm.application.services.farm_service.FarmService" href="../../farm/use_cases/#app.farm.application.services.farm_service.FarmService">FarmService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Servicio para lógica de negocio de fincas.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.task_service">task_service</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.application.services.task_service.TaskService">TaskService</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Servicio para lógica de negocio de tareas.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>app\cultural_practices\application\change_task_state_use_case.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ChangeTaskStateUseCase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Caso de uso para cambiar el estado de una tarea de labor cultural.</span>

<span class="sd">    Este caso de uso gestiona la lógica de negocio para cambiar el estado de una tarea,</span>
<span class="sd">    asegurando que se cumplan las validaciones necesarias antes de realizar el cambio.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        cultural_practice_repository (CulturalPracticesRepository): Repositorio para operaciones de prácticas culturales.</span>
<span class="sd">        plot_repository (PlotRepository): Repositorio para operaciones de lotes.</span>
<span class="sd">        farm_repository (FarmRepository): Repositorio para operaciones de fincas.</span>
<span class="sd">        farm_service (FarmService): Servicio para lógica de negocio de fincas.</span>
<span class="sd">        task_service (TaskService): Servicio para lógica de negocio de tareas.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">        Args:</span>
<span class="sd">            db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span> <span class="o">=</span> <span class="n">PlotRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span> <span class="o">=</span> <span class="n">FarmRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_service</span> <span class="o">=</span> <span class="n">TaskService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">change_task_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">state_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SuccessResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cambia el estado de una tarea de labor cultural.</span>

<span class="sd">        Este método valida la existencia de la tarea y del estado, así como los permisos del usuario</span>
<span class="sd">        que intenta realizar el cambio. Si las validaciones son exitosas, actualiza el estado de la tarea</span>
<span class="sd">        y establece la fecha de finalización si el nuevo estado es &quot;Completada&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            task_id (int): ID de la tarea cuyo estado se desea cambiar.</span>
<span class="sd">            state_id (int): ID del nuevo estado que se asignará a la tarea.</span>
<span class="sd">            current_user (UserInDB): Usuario actual autenticado que intenta cambiar el estado.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SuccessResponse: Respuesta que indica que el estado de la tarea fue cambiado exitosamente.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DomainException: Si la tarea, el estado, o los permisos del usuario no son válidos.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validar existencia de la tarea</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;La tarea especificada no existe.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Validar permisos del usuario</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_can_change_task_state</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para cambiar el estado de esta tarea.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
            <span class="p">)</span>

        <span class="c1"># Obtener tarea por ID</span>
        <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la tarea.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="n">target_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_state_by_id</span><span class="p">(</span><span class="n">state_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">target_state</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el estado al cuál se quiere cambiar la tarea.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="n">task</span><span class="o">.</span><span class="n">estado_id</span> <span class="o">=</span> <span class="n">state_id</span>

        <span class="n">target_state_name</span> <span class="o">=</span> <span class="n">target_state</span><span class="o">.</span><span class="n">nombre</span>

        <span class="k">if</span> <span class="n">target_state_name</span> <span class="o">==</span> <span class="n">TaskService</span><span class="o">.</span><span class="n">COMPLETADA</span><span class="p">:</span>
            <span class="n">task</span><span class="o">.</span><span class="n">fecha_finalizacion</span> <span class="o">=</span> <span class="n">datetime_utc_time</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">task</span><span class="o">.</span><span class="n">fecha_finalizacion</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">update_task</span><span class="p">(</span><span class="n">task</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo actualizar el estado de la tarea.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span>
            <span class="p">)</span>

        <span class="c1"># Obtener nombre del estado por ID</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_state_by_id</span><span class="p">(</span><span class="n">state_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el estado de la tarea.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">SuccessResponse</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Estado de la tarea cambiado exitosamente a &quot;</span> <span class="o">+</span> <span class="n">state</span><span class="o">.</span><span class="n">nombre</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">user_can_change_task_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verifica si un usuario tiene permisos para cambiar el estado de una tarea.</span>

<span class="sd">        Este método valida la existencia de la tarea, el lote y la finca asociada, y verifica si el usuario</span>
<span class="sd">        es administrador de la finca.</span>

<span class="sd">        Args:</span>
<span class="sd">            user_id (int): ID del usuario que intenta cambiar el estado.</span>
<span class="sd">            task_id (int): ID de la tarea cuyo estado se desea cambiar.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True si el usuario tiene permisos para cambiar el estado, False en caso contrario.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DomainException: Si la tarea, el lote o la finca no existen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Obtener tarea por ID</span>
        <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la tarea.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Obtener lote por ID</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span><span class="o">.</span><span class="n">get_plot_by_id</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">lote_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plot</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el lote.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Obtener finca por ID</span>
        <span class="n">farm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span><span class="o">.</span><span class="n">get_farm_by_id</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">finca_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">farm</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la finca.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Verificar si el usuario es administrador de la finca</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">farm</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inicializa el caso de uso con las dependencias necesarias.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>db</code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\change_task_state_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">    Args:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span> <span class="o">=</span> <span class="n">PlotRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span> <span class="o">=</span> <span class="n">FarmRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task_service</span> <span class="o">=</span> <span class="n">TaskService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.change_task_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">change_task_state</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">state_id</span><span class="p">,</span> <span class="n">current_user</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Cambia el estado de una tarea de labor cultural.</p>
<p>Este método valida la existencia de la tarea y del estado, así como los permisos del usuario
que intenta realizar el cambio. Si las validaciones son exitosas, actualiza el estado de la tarea
y establece la fecha de finalización si el nuevo estado es "Completada".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>task_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID de la tarea cuyo estado se desea cambiar.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>state_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID del nuevo estado que se asignará a la tarea.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>current_user</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.user.domain.schemas.UserInDB" href="../../user/schemas/#app.user.domain.schemas.UserInDB">UserInDB</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Usuario actual autenticado que intenta cambiar el estado.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SuccessResponse</code></td>            <td>
                  <code><span title="app.infrastructure.common.response_models.SuccessResponse">SuccessResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Respuesta que indica que el estado de la tarea fue cambiado exitosamente.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="app.infrastructure.common.common_exceptions.DomainException">DomainException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Si la tarea, el estado, o los permisos del usuario no son válidos.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\change_task_state_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">change_task_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">state_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SuccessResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cambia el estado de una tarea de labor cultural.</span>

<span class="sd">    Este método valida la existencia de la tarea y del estado, así como los permisos del usuario</span>
<span class="sd">    que intenta realizar el cambio. Si las validaciones son exitosas, actualiza el estado de la tarea</span>
<span class="sd">    y establece la fecha de finalización si el nuevo estado es &quot;Completada&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        task_id (int): ID de la tarea cuyo estado se desea cambiar.</span>
<span class="sd">        state_id (int): ID del nuevo estado que se asignará a la tarea.</span>
<span class="sd">        current_user (UserInDB): Usuario actual autenticado que intenta cambiar el estado.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SuccessResponse: Respuesta que indica que el estado de la tarea fue cambiado exitosamente.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DomainException: Si la tarea, el estado, o los permisos del usuario no son válidos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validar existencia de la tarea</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;La tarea especificada no existe.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Validar permisos del usuario</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_can_change_task_state</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para cambiar el estado de esta tarea.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
        <span class="p">)</span>

    <span class="c1"># Obtener tarea por ID</span>
    <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la tarea.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="n">target_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_state_by_id</span><span class="p">(</span><span class="n">state_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_state</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el estado al cuál se quiere cambiar la tarea.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="n">task</span><span class="o">.</span><span class="n">estado_id</span> <span class="o">=</span> <span class="n">state_id</span>

    <span class="n">target_state_name</span> <span class="o">=</span> <span class="n">target_state</span><span class="o">.</span><span class="n">nombre</span>

    <span class="k">if</span> <span class="n">target_state_name</span> <span class="o">==</span> <span class="n">TaskService</span><span class="o">.</span><span class="n">COMPLETADA</span><span class="p">:</span>
        <span class="n">task</span><span class="o">.</span><span class="n">fecha_finalizacion</span> <span class="o">=</span> <span class="n">datetime_utc_time</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">task</span><span class="o">.</span><span class="n">fecha_finalizacion</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">update_task</span><span class="p">(</span><span class="n">task</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo actualizar el estado de la tarea.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span>
        <span class="p">)</span>

    <span class="c1"># Obtener nombre del estado por ID</span>
    <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_state_by_id</span><span class="p">(</span><span class="n">state_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el estado de la tarea.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">SuccessResponse</span><span class="p">(</span>
        <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Estado de la tarea cambiado exitosamente a &quot;</span> <span class="o">+</span> <span class="n">state</span><span class="o">.</span><span class="n">nombre</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.change_task_state_use_case.ChangeTaskStateUseCase.user_can_change_task_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">user_can_change_task_state</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">task_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Verifica si un usuario tiene permisos para cambiar el estado de una tarea.</p>
<p>Este método valida la existencia de la tarea, el lote y la finca asociada, y verifica si el usuario
es administrador de la finca.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>user_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID del usuario que intenta cambiar el estado.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>task_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID de la tarea cuyo estado se desea cambiar.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True si el usuario tiene permisos para cambiar el estado, False en caso contrario.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="app.infrastructure.common.common_exceptions.DomainException">DomainException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Si la tarea, el lote o la finca no existen.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\change_task_state_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">user_can_change_task_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verifica si un usuario tiene permisos para cambiar el estado de una tarea.</span>

<span class="sd">    Este método valida la existencia de la tarea, el lote y la finca asociada, y verifica si el usuario</span>
<span class="sd">    es administrador de la finca.</span>

<span class="sd">    Args:</span>
<span class="sd">        user_id (int): ID del usuario que intenta cambiar el estado.</span>
<span class="sd">        task_id (int): ID de la tarea cuyo estado se desea cambiar.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True si el usuario tiene permisos para cambiar el estado, False en caso contrario.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DomainException: Si la tarea, el lote o la finca no existen.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Obtener tarea por ID</span>
    <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la tarea.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Obtener lote por ID</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span><span class="o">.</span><span class="n">get_plot_by_id</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">lote_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">plot</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el lote.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Obtener finca por ID</span>
    <span class="n">farm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span><span class="o">.</span><span class="n">get_farm_by_id</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">finca_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">farm</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la finca.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Verificar si el usuario es administrador de la finca</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">farm</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="crear-tarea">Crear Tarea</h2>


<div class="doc doc-object doc-class">



<a id="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase"></a>
    <div class="doc doc-contents first">


        <p>Caso de uso para crear tareas de labor cultural.</p>
<p>Este caso de uso gestiona la lógica de negocio para la creación de tareas, asegurando que se cumplan
las validaciones necesarias antes de realizar la creación.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.db">db</span></code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.cultural_practice_repository">cultural_practice_repository</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.infrastructure.sql_repository.CulturalPracticesRepository">CulturalPracticesRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de prácticas culturales.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.farm_repository">farm_repository</span></code></td>
            <td>
                  <code><span title="app.farm.infrastructure.sql_repository.FarmRepository">FarmRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de fincas.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.plot_repository">plot_repository</span></code></td>
            <td>
                  <code><span title="app.plot.infrastructure.sql_repository.PlotRepository">PlotRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de lotes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.farm_service">farm_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.farm.application.services.farm_service.FarmService" href="../../farm/use_cases/#app.farm.application.services.farm_service.FarmService">FarmService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Servicio para lógica de negocio de fincas.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.task_service">task_service</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.application.services.task_service.TaskService">TaskService</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Servicio para lógica de negocio de tareas.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.crop_repository">crop_repository</span></code></td>
            <td>
                  <code><span title="app.crop.infrastructure.sql_repository.CropRepository">CropRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de cultivos.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>app\cultural_practices\application\create_task_use_case.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CreateTaskUseCase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Caso de uso para crear tareas de labor cultural.</span>

<span class="sd">    Este caso de uso gestiona la lógica de negocio para la creación de tareas, asegurando que se cumplan</span>
<span class="sd">    las validaciones necesarias antes de realizar la creación.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        cultural_practice_repository (CulturalPracticesRepository): Repositorio para operaciones de prácticas culturales.</span>
<span class="sd">        farm_repository (FarmRepository): Repositorio para operaciones de fincas.</span>
<span class="sd">        plot_repository (PlotRepository): Repositorio para operaciones de lotes.</span>
<span class="sd">        farm_service (FarmService): Servicio para lógica de negocio de fincas.</span>
<span class="sd">        task_service (TaskService): Servicio para lógica de negocio de tareas.</span>
<span class="sd">        crop_repository (CropRepository): Repositorio para operaciones de cultivos.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">        Args:</span>
<span class="sd">            db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span> <span class="o">=</span> <span class="n">FarmRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span> <span class="o">=</span> <span class="n">PlotRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_service</span> <span class="o">=</span> <span class="n">TaskService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crop_repository</span> <span class="o">=</span> <span class="n">CropRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_data</span><span class="p">:</span> <span class="n">TaskCreate</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SuccessTaskCreateResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Crea una nueva tarea de labor cultural.</span>

<span class="sd">        Este método valida la existencia del lote, el cultivo activo en el lote, la finca asociada,</span>
<span class="sd">        y los permisos del usuario que intenta crear la tarea. Si todas las validaciones son exitosas,</span>
<span class="sd">        se crea la tarea.</span>

<span class="sd">        Args:</span>
<span class="sd">            task_data (TaskCreate): Datos de la tarea a crear.</span>
<span class="sd">            current_user (UserInDB): Usuario actual autenticado que intenta crear la tarea.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SuccessTaskCreateResponse: Respuesta que indica que la tarea fue creada exitosamente.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DomainException: Si el lote, la finca, el cultivo activo, el tipo de labor cultural o el estado de tarea no son válidos.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span><span class="o">.</span><span class="n">get_plot_by_id</span><span class="p">(</span><span class="n">task_data</span><span class="o">.</span><span class="n">lote_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plot</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el lote.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Validar que el lote tiene un cultivo activo</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">crop_repository</span><span class="o">.</span><span class="n">has_active_crop</span><span class="p">(</span><span class="n">task_data</span><span class="o">.</span><span class="n">lote_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El lote no tiene un cultivo activo. No se pueden crear tareas en lotes sin cultivos activos.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_409_CONFLICT</span>
            <span class="p">)</span>

        <span class="c1"># Buscar el id de la finca por medio del id del lote</span>
        <span class="n">farm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span><span class="o">.</span><span class="n">get_farm_by_id</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">finca_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">farm</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la finca.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span>
            <span class="p">)</span>

        <span class="c1"># Validar que el usuario sea administrador de la finca</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">farm</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para crear tareas en esta finca.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
            <span class="p">)</span>

        <span class="c1"># Verificar si el tipo de labor cultural existe</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_type_by_id</span><span class="p">(</span><span class="n">task_data</span><span class="o">.</span><span class="n">tipo_labor_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El tipo de labor cultural especificado no existe.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Verificar si el estado de tarea existe</span>
        <span class="n">task_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_state_by_id</span><span class="p">(</span><span class="n">task_data</span><span class="o">.</span><span class="n">estado_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task_state</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El estado de tarea especificado no existe.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Crear la tarea</span>
        <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">task_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo crear la tarea de labor cultural.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">SuccessTaskCreateResponse</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Tarea creada exitosamente&quot;</span><span class="p">,</span> <span class="n">task_id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inicializa el caso de uso con las dependencias necesarias.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>db</code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\create_task_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">    Args:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span> <span class="o">=</span> <span class="n">FarmRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span> <span class="o">=</span> <span class="n">PlotRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task_service</span> <span class="o">=</span> <span class="n">TaskService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crop_repository</span> <span class="o">=</span> <span class="n">CropRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.create_task_use_case.CreateTaskUseCase.create_task" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_task</span><span class="p">(</span><span class="n">task_data</span><span class="p">,</span> <span class="n">current_user</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Crea una nueva tarea de labor cultural.</p>
<p>Este método valida la existencia del lote, el cultivo activo en el lote, la finca asociada,
y los permisos del usuario que intenta crear la tarea. Si todas las validaciones son exitosas,
se crea la tarea.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>task_data</code></td>
            <td>
                  <code><span title="app.cultural_practices.domain.schemas.TaskCreate">TaskCreate</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datos de la tarea a crear.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>current_user</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.user.domain.schemas.UserInDB" href="../../user/schemas/#app.user.domain.schemas.UserInDB">UserInDB</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Usuario actual autenticado que intenta crear la tarea.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SuccessTaskCreateResponse</code></td>            <td>
                  <code><span title="app.cultural_practices.domain.schemas.SuccessTaskCreateResponse">SuccessTaskCreateResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Respuesta que indica que la tarea fue creada exitosamente.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="app.infrastructure.common.common_exceptions.DomainException">DomainException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Si el lote, la finca, el cultivo activo, el tipo de labor cultural o el estado de tarea no son válidos.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\create_task_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_data</span><span class="p">:</span> <span class="n">TaskCreate</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SuccessTaskCreateResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Crea una nueva tarea de labor cultural.</span>

<span class="sd">    Este método valida la existencia del lote, el cultivo activo en el lote, la finca asociada,</span>
<span class="sd">    y los permisos del usuario que intenta crear la tarea. Si todas las validaciones son exitosas,</span>
<span class="sd">    se crea la tarea.</span>

<span class="sd">    Args:</span>
<span class="sd">        task_data (TaskCreate): Datos de la tarea a crear.</span>
<span class="sd">        current_user (UserInDB): Usuario actual autenticado que intenta crear la tarea.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SuccessTaskCreateResponse: Respuesta que indica que la tarea fue creada exitosamente.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DomainException: Si el lote, la finca, el cultivo activo, el tipo de labor cultural o el estado de tarea no son válidos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_repository</span><span class="o">.</span><span class="n">get_plot_by_id</span><span class="p">(</span><span class="n">task_data</span><span class="o">.</span><span class="n">lote_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">plot</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener el lote.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Validar que el lote tiene un cultivo activo</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">crop_repository</span><span class="o">.</span><span class="n">has_active_crop</span><span class="p">(</span><span class="n">task_data</span><span class="o">.</span><span class="n">lote_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El lote no tiene un cultivo activo. No se pueden crear tareas en lotes sin cultivos activos.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_409_CONFLICT</span>
        <span class="p">)</span>

    <span class="c1"># Buscar el id de la finca por medio del id del lote</span>
    <span class="n">farm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span><span class="o">.</span><span class="n">get_farm_by_id</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">finca_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">farm</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo obtener la finca.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span>
        <span class="p">)</span>

    <span class="c1"># Validar que el usuario sea administrador de la finca</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">farm</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para crear tareas en esta finca.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
        <span class="p">)</span>

    <span class="c1"># Verificar si el tipo de labor cultural existe</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_type_by_id</span><span class="p">(</span><span class="n">task_data</span><span class="o">.</span><span class="n">tipo_labor_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El tipo de labor cultural especificado no existe.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Verificar si el estado de tarea existe</span>
    <span class="n">task_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_state_by_id</span><span class="p">(</span><span class="n">task_data</span><span class="o">.</span><span class="n">estado_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">task_state</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El estado de tarea especificado no existe.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Crear la tarea</span>
    <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">task_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No se pudo crear la tarea de labor cultural.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_500_INTERNAL_SERVER_ERROR</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">SuccessTaskCreateResponse</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Tarea creada exitosamente&quot;</span><span class="p">,</span> <span class="n">task_id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="obtener-tarea-por-id">Obtener Tarea por ID</h2>


<div class="doc doc-object doc-class">



<a id="app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase"></a>
    <div class="doc doc-contents first">


        <p>Caso de uso para obtener una tarea de labor cultural por su ID.</p>
<p>Este caso de uso gestiona la lógica de negocio para recuperar una tarea específica,
asegurando que se cumplan las validaciones necesarias antes de devolver la tarea.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.db">db</span></code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.cultural_practice_repository">cultural_practice_repository</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.infrastructure.sql_repository.CulturalPracticesRepository">CulturalPracticesRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de prácticas culturales.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.farm_service">farm_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.farm.application.services.farm_service.FarmService" href="../../farm/use_cases/#app.farm.application.services.farm_service.FarmService">FarmService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Servicio para lógica de negocio de fincas.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.farm_repository">farm_repository</span></code></td>
            <td>
                  <code><span title="app.farm.infrastructure.sql_repository.FarmRepository">FarmRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de fincas.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>app\cultural_practices\application\get_task_by_id_use_case.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GetTaskByIdUseCase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Caso de uso para obtener una tarea de labor cultural por su ID.</span>

<span class="sd">    Este caso de uso gestiona la lógica de negocio para recuperar una tarea específica,</span>
<span class="sd">    asegurando que se cumplan las validaciones necesarias antes de devolver la tarea.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        cultural_practice_repository (CulturalPracticesRepository): Repositorio para operaciones de prácticas culturales.</span>
<span class="sd">        farm_service (FarmService): Servicio para lógica de negocio de fincas.</span>
<span class="sd">        farm_repository (FarmRepository): Repositorio para operaciones de fincas.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">        Args:</span>
<span class="sd">            db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span> <span class="o">=</span> <span class="n">FarmRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_task_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Obtiene una tarea de labor cultural por su ID.</span>

<span class="sd">        Este método valida la existencia de la tarea y verifica si el usuario tiene permisos</span>
<span class="sd">        para acceder a la tarea. Si las validaciones son exitosas, devuelve la tarea.</span>

<span class="sd">        Args:</span>
<span class="sd">            farm_id (int): ID de la finca a la que pertenece la tarea.</span>
<span class="sd">            task_id (int): ID de la tarea que se desea obtener.</span>
<span class="sd">            current_user (UserInDB): Usuario actual autenticado que intenta acceder a la tarea.</span>

<span class="sd">        Returns:</span>
<span class="sd">            TaskResponse: Respuesta que contiene los detalles de la tarea.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DomainException: Si la tarea no existe o si el usuario no tiene permisos para acceder a ella.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validar que la tarea existe</span>
        <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;La tarea especificada no existe.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="c1"># Validar que el usuario es el administrador de la finca</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para acceder a esta tarea.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">TaskResponse</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">nombre</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span>
            <span class="n">tipo_labor_id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">tipo_labor_id</span><span class="p">,</span>
            <span class="n">fecha_inicio_estimada</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">fecha_inicio_estimada</span><span class="p">,</span>
            <span class="n">fecha_finalizacion</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">fecha_finalizacion</span><span class="p">,</span>
            <span class="n">descripcion</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">descripcion</span><span class="p">,</span>
            <span class="n">estado_id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">estado_id</span><span class="p">,</span>
            <span class="n">lote_id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">lote_id</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inicializa el caso de uso con las dependencias necesarias.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>db</code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\get_task_by_id_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">    Args:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_repository</span> <span class="o">=</span> <span class="n">FarmRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.get_task_by_id_use_case.GetTaskByIdUseCase.get_task_by_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">farm_id</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">current_user</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Obtiene una tarea de labor cultural por su ID.</p>
<p>Este método valida la existencia de la tarea y verifica si el usuario tiene permisos
para acceder a la tarea. Si las validaciones son exitosas, devuelve la tarea.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>farm_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID de la finca a la que pertenece la tarea.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>task_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID de la tarea que se desea obtener.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>current_user</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.user.domain.schemas.UserInDB" href="../../user/schemas/#app.user.domain.schemas.UserInDB">UserInDB</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Usuario actual autenticado que intenta acceder a la tarea.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TaskResponse</code></td>            <td>
                  <code><span title="app.cultural_practices.domain.schemas.TaskResponse">TaskResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Respuesta que contiene los detalles de la tarea.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="app.infrastructure.common.common_exceptions.DomainException">DomainException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Si la tarea no existe o si el usuario no tiene permisos para acceder a ella.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\get_task_by_id_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_task_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtiene una tarea de labor cultural por su ID.</span>

<span class="sd">    Este método valida la existencia de la tarea y verifica si el usuario tiene permisos</span>
<span class="sd">    para acceder a la tarea. Si las validaciones son exitosas, devuelve la tarea.</span>

<span class="sd">    Args:</span>
<span class="sd">        farm_id (int): ID de la finca a la que pertenece la tarea.</span>
<span class="sd">        task_id (int): ID de la tarea que se desea obtener.</span>
<span class="sd">        current_user (UserInDB): Usuario actual autenticado que intenta acceder a la tarea.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TaskResponse: Respuesta que contiene los detalles de la tarea.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DomainException: Si la tarea no existe o si el usuario no tiene permisos para acceder a ella.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validar que la tarea existe</span>
    <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_by_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;La tarea especificada no existe.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="c1"># Validar que el usuario es el administrador de la finca</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para acceder a esta tarea.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">TaskResponse</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">nombre</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span>
        <span class="n">tipo_labor_id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">tipo_labor_id</span><span class="p">,</span>
        <span class="n">fecha_inicio_estimada</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">fecha_inicio_estimada</span><span class="p">,</span>
        <span class="n">fecha_finalizacion</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">fecha_finalizacion</span><span class="p">,</span>
        <span class="n">descripcion</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">descripcion</span><span class="p">,</span>
        <span class="n">estado_id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">estado_id</span><span class="p">,</span>
        <span class="n">lote_id</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">lote_id</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="listar-tareas-por-usuario-y-finca">Listar Tareas por Usuario y Finca</h2>


<div class="doc doc-object doc-class">



<a id="app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase"></a>
    <div class="doc doc-contents first">


        <p>Caso de uso para listar las tareas de un usuario en una finca específica.</p>
<p>Este caso de uso gestiona la lógica de negocio para recuperar las tareas asignadas a un usuario
en una finca específica, asegurando que se cumplan las validaciones necesarias antes de devolver
la lista de tareas.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.db">db</span></code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.cultural_practice_repository">cultural_practice_repository</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.infrastructure.sql_repository.CulturalPracticesRepository">CulturalPracticesRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de prácticas culturales.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.user_repository">user_repository</span></code></td>
            <td>
                  <code><span title="app.user.infrastructure.sql_repository.UserRepository">UserRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de usuarios.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.farm_service">farm_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.farm.application.services.farm_service.FarmService" href="../../farm/use_cases/#app.farm.application.services.farm_service.FarmService">FarmService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Servicio para lógica de negocio de fincas.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>app\cultural_practices\application\list_tasks_by_user_and_farm_use_case.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ListTasksByUserAndFarmUseCase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Caso de uso para listar las tareas de un usuario en una finca específica.</span>

<span class="sd">    Este caso de uso gestiona la lógica de negocio para recuperar las tareas asignadas a un usuario</span>
<span class="sd">    en una finca específica, asegurando que se cumplan las validaciones necesarias antes de devolver</span>
<span class="sd">    la lista de tareas.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        cultural_practice_repository (CulturalPracticesRepository): Repositorio para operaciones de prácticas culturales.</span>
<span class="sd">        user_repository (UserRepository): Repositorio para operaciones de usuarios.</span>
<span class="sd">        farm_service (FarmService): Servicio para lógica de negocio de fincas.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">        Args:</span>
<span class="sd">            db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span> <span class="o">=</span> <span class="n">UserRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_tasks_by_user_and_farm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">per_page</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaginatedTaskListResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lista las tareas de un usuario en una finca específica de forma paginada.</span>

<span class="sd">        Este método valida que el usuario actual tenga permisos para acceder a las tareas del usuario</span>
<span class="sd">        especificado en la finca indicada. Si las validaciones son exitosas, devuelve una lista paginada</span>
<span class="sd">        de las tareas.</span>

<span class="sd">        Args:</span>
<span class="sd">            farm_id (int): ID de la finca de la que se desean listar las tareas.</span>
<span class="sd">            user_id (int): ID del usuario cuyas tareas se desean listar.</span>
<span class="sd">            page (int): Número de página para la paginación.</span>
<span class="sd">            per_page (int): Cantidad de tareas por página.</span>
<span class="sd">            current_user (UserInDB): Usuario actual autenticado que intenta acceder a las tareas.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PaginatedTaskListResponse: Respuesta que contiene la lista paginada de tareas del usuario.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DomainException: Si el usuario no tiene permisos, no existe, o no es trabajador de la finca.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># validar que el usuario es administrador de la finca</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para listar las tareas de este usuario.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
            <span class="p">)</span>

        <span class="c1"># validar que el usuario existe</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span><span class="o">.</span><span class="n">get_user_by_id</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El usuario especificado no existe.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">current_user</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El usuario es el administrador de la finca.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
            <span class="p">)</span>

        <span class="c1"># validar que el usuario pertenezca a la finca</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_worker</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El usuario no es trabajador en la finca especificada.&quot;</span><span class="p">,</span>
                <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
            <span class="p">)</span>

        <span class="c1"># listar las tareas del usuario filtradas por la finca</span>
        <span class="n">total_tasks</span><span class="p">,</span> <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">list_tasks_by_user_and_farm_paginated</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">per_page</span><span class="p">)</span>

        <span class="n">task_responses</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_task_to_response</span><span class="p">(</span><span class="n">task</span><span class="p">)</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">]</span>

        <span class="n">total_pages</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">total_tasks</span> <span class="o">/</span> <span class="n">per_page</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">PaginatedTaskListResponse</span><span class="p">(</span>
            <span class="n">tasks</span><span class="o">=</span><span class="n">task_responses</span><span class="p">,</span>
            <span class="n">total_tasks</span><span class="o">=</span><span class="n">total_tasks</span><span class="p">,</span>
            <span class="n">page</span><span class="o">=</span><span class="n">page</span><span class="p">,</span>
            <span class="n">per_page</span><span class="o">=</span><span class="n">per_page</span><span class="p">,</span>
            <span class="n">total_pages</span><span class="o">=</span><span class="n">total_pages</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inicializa el caso de uso con las dependencias necesarias.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>db</code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\list_tasks_by_user_and_farm_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">    Args:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span> <span class="o">=</span> <span class="n">UserRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span> <span class="o">=</span> <span class="n">FarmService</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.list_tasks_by_user_and_farm_use_case.ListTasksByUserAndFarmUseCase.list_tasks_by_user_and_farm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_tasks_by_user_and_farm</span><span class="p">(</span><span class="n">farm_id</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">per_page</span><span class="p">,</span> <span class="n">current_user</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Lista las tareas de un usuario en una finca específica de forma paginada.</p>
<p>Este método valida que el usuario actual tenga permisos para acceder a las tareas del usuario
especificado en la finca indicada. Si las validaciones son exitosas, devuelve una lista paginada
de las tareas.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>farm_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID de la finca de la que se desean listar las tareas.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>user_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID del usuario cuyas tareas se desean listar.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>page</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Número de página para la paginación.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>per_page</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cantidad de tareas por página.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>current_user</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.user.domain.schemas.UserInDB" href="../../user/schemas/#app.user.domain.schemas.UserInDB">UserInDB</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Usuario actual autenticado que intenta acceder a las tareas.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PaginatedTaskListResponse</code></td>            <td>
                  <code><span title="app.cultural_practices.domain.schemas.PaginatedTaskListResponse">PaginatedTaskListResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Respuesta que contiene la lista paginada de tareas del usuario.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="app.infrastructure.common.common_exceptions.DomainException">DomainException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Si el usuario no tiene permisos, no existe, o no es trabajador de la finca.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\list_tasks_by_user_and_farm_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_tasks_by_user_and_farm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">per_page</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaginatedTaskListResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lista las tareas de un usuario en una finca específica de forma paginada.</span>

<span class="sd">    Este método valida que el usuario actual tenga permisos para acceder a las tareas del usuario</span>
<span class="sd">    especificado en la finca indicada. Si las validaciones son exitosas, devuelve una lista paginada</span>
<span class="sd">    de las tareas.</span>

<span class="sd">    Args:</span>
<span class="sd">        farm_id (int): ID de la finca de la que se desean listar las tareas.</span>
<span class="sd">        user_id (int): ID del usuario cuyas tareas se desean listar.</span>
<span class="sd">        page (int): Número de página para la paginación.</span>
<span class="sd">        per_page (int): Cantidad de tareas por página.</span>
<span class="sd">        current_user (UserInDB): Usuario actual autenticado que intenta acceder a las tareas.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PaginatedTaskListResponse: Respuesta que contiene la lista paginada de tareas del usuario.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DomainException: Si el usuario no tiene permisos, no existe, o no es trabajador de la finca.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># validar que el usuario es administrador de la finca</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_admin</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No tienes permisos para listar las tareas de este usuario.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
        <span class="p">)</span>

    <span class="c1"># validar que el usuario existe</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span><span class="o">.</span><span class="n">get_user_by_id</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El usuario especificado no existe.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">current_user</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El usuario es el administrador de la finca.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
        <span class="p">)</span>

    <span class="c1"># validar que el usuario pertenezca a la finca</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">farm_service</span><span class="o">.</span><span class="n">user_is_farm_worker</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;El usuario no es trabajador en la finca especificada.&quot;</span><span class="p">,</span>
            <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_403_FORBIDDEN</span>
        <span class="p">)</span>

    <span class="c1"># listar las tareas del usuario filtradas por la finca</span>
    <span class="n">total_tasks</span><span class="p">,</span> <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">list_tasks_by_user_and_farm_paginated</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">farm_id</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">per_page</span><span class="p">)</span>

    <span class="n">task_responses</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_task_to_response</span><span class="p">(</span><span class="n">task</span><span class="p">)</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">]</span>

    <span class="n">total_pages</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">total_tasks</span> <span class="o">/</span> <span class="n">per_page</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">PaginatedTaskListResponse</span><span class="p">(</span>
        <span class="n">tasks</span><span class="o">=</span><span class="n">task_responses</span><span class="p">,</span>
        <span class="n">total_tasks</span><span class="o">=</span><span class="n">total_tasks</span><span class="p">,</span>
        <span class="n">page</span><span class="o">=</span><span class="n">page</span><span class="p">,</span>
        <span class="n">per_page</span><span class="o">=</span><span class="n">per_page</span><span class="p">,</span>
        <span class="n">total_pages</span><span class="o">=</span><span class="n">total_pages</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="listar-estados-de-tareas">Listar Estados de Tareas</h2>


<div class="doc doc-object doc-class">



<a id="app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase"></a>
    <div class="doc doc-contents first">


        <p>Caso de uso para listar los estados de las tareas de labor cultural.</p>
<p>Este caso de uso gestiona la lógica de negocio para recuperar todos los estados de las tareas,
asegurando que se cumplan las validaciones necesarias antes de devolver la lista de estados.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase.db">db</span></code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase.cultural_practice_repository">cultural_practice_repository</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.infrastructure.sql_repository.CulturalPracticesRepository">CulturalPracticesRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de prácticas culturales.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>app\cultural_practices\application\list_task_states_use_case.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ListTaskStatesUseCase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Caso de uso para listar los estados de las tareas de labor cultural.</span>

<span class="sd">    Este caso de uso gestiona la lógica de negocio para recuperar todos los estados de las tareas,</span>
<span class="sd">    asegurando que se cumplan las validaciones necesarias antes de devolver la lista de estados.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        cultural_practice_repository (CulturalPracticesRepository): Repositorio para operaciones de prácticas culturales.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">        Args:</span>
<span class="sd">            db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_task_states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskStateListResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lista todos los estados de las tareas de labor cultural.</span>

<span class="sd">        Este método obtiene todos los estados de las tareas desde el repositorio y los mapea a</span>
<span class="sd">        objetos de respuesta. Si ocurre un error durante la obtención, se lanza una excepción.</span>

<span class="sd">        Args:</span>
<span class="sd">            current_user (UserInDB): Usuario actual autenticado que intenta acceder a los estados.</span>

<span class="sd">        Returns:</span>
<span class="sd">            TaskStateListResponse: Respuesta que contiene la lista de estados de las tareas.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DomainException: Si ocurre un error al obtener los estados de las tareas.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Asumiendo que el método del repositorio devuelve una lista de objetos de estado de tarea</span>
            <span class="n">task_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>

            <span class="c1"># Crear objetos TaskStateResponse</span>
            <span class="n">task_state_responses</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_task_state_to_response</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">task_states</span><span class="p">]</span>

            <span class="c1"># Retornar un objeto TaskStateListResponse</span>
            <span class="k">return</span> <span class="n">TaskStateListResponse</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="n">task_state_responses</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error obteniendo los estados de las tareas: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inicializa el caso de uso con las dependencias necesarias.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>db</code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\list_task_states_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">    Args:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.list_task_states_use_case.ListTaskStatesUseCase.list_task_states" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_task_states</span><span class="p">(</span><span class="n">current_user</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Lista todos los estados de las tareas de labor cultural.</p>
<p>Este método obtiene todos los estados de las tareas desde el repositorio y los mapea a
objetos de respuesta. Si ocurre un error durante la obtención, se lanza una excepción.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>current_user</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.user.domain.schemas.UserInDB" href="../../user/schemas/#app.user.domain.schemas.UserInDB">UserInDB</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Usuario actual autenticado que intenta acceder a los estados.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TaskStateListResponse</code></td>            <td>
                  <code><span title="app.cultural_practices.domain.schemas.TaskStateListResponse">TaskStateListResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Respuesta que contiene la lista de estados de las tareas.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="app.infrastructure.common.common_exceptions.DomainException">DomainException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Si ocurre un error al obtener los estados de las tareas.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\list_task_states_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_task_states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskStateListResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lista todos los estados de las tareas de labor cultural.</span>

<span class="sd">    Este método obtiene todos los estados de las tareas desde el repositorio y los mapea a</span>
<span class="sd">    objetos de respuesta. Si ocurre un error durante la obtención, se lanza una excepción.</span>

<span class="sd">    Args:</span>
<span class="sd">        current_user (UserInDB): Usuario actual autenticado que intenta acceder a los estados.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TaskStateListResponse: Respuesta que contiene la lista de estados de las tareas.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DomainException: Si ocurre un error al obtener los estados de las tareas.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Asumiendo que el método del repositorio devuelve una lista de objetos de estado de tarea</span>
        <span class="n">task_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>

        <span class="c1"># Crear objetos TaskStateResponse</span>
        <span class="n">task_state_responses</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_task_state_to_response</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">task_states</span><span class="p">]</span>

        <span class="c1"># Retornar un objeto TaskStateListResponse</span>
        <span class="k">return</span> <span class="n">TaskStateListResponse</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="n">task_state_responses</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DomainException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error obteniendo los estados de las tareas: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="listar-tipos-de-tareas">Listar Tipos de Tareas</h2>


<div class="doc doc-object doc-class">



<a id="app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase"></a>
    <div class="doc doc-contents first">


        <p>Caso de uso para listar los tipos de tareas de labor cultural.</p>
<p>Este caso de uso gestiona la lógica de negocio para recuperar todos los tipos de tareas,
asegurando que se cumplan las validaciones necesarias antes de devolver la lista de tipos.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase.db">db</span></code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase.cultural_practice_repository">cultural_practice_repository</span></code></td>
            <td>
                  <code><span title="app.cultural_practices.infrastructure.sql_repository.CulturalPracticesRepository">CulturalPracticesRepository</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Repositorio para operaciones de prácticas culturales.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>app\cultural_practices\application\list_task_types_use_case.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ListTaskTypesUseCase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Caso de uso para listar los tipos de tareas de labor cultural.</span>

<span class="sd">    Este caso de uso gestiona la lógica de negocio para recuperar todos los tipos de tareas,</span>
<span class="sd">    asegurando que se cumplan las validaciones necesarias antes de devolver la lista de tipos.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        cultural_practice_repository (CulturalPracticesRepository): Repositorio para operaciones de prácticas culturales.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">        Args:</span>
<span class="sd">            db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_task_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskTypeListResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lista todos los tipos de tareas de labor cultural.</span>

<span class="sd">        Este método obtiene todos los tipos de tareas desde el repositorio y los mapea a</span>
<span class="sd">        objetos de respuesta.</span>

<span class="sd">        Args:</span>
<span class="sd">            current_user (UserInDB): Usuario actual autenticado que intenta acceder a los tipos de tareas.</span>

<span class="sd">        Returns:</span>
<span class="sd">            TaskTypeListResponse: Respuesta que contiene la lista de tipos de tareas.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">task_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_types</span><span class="p">()</span>
        <span class="n">task_type_responses</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_task_type_to_response</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span> <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">task_types</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">TaskTypeListResponse</span><span class="p">(</span><span class="n">task_types</span><span class="o">=</span><span class="n">task_type_responses</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inicializa el caso de uso con las dependencias necesarias.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>db</code></td>
            <td>
                  <code><span title="sqlalchemy.orm.Session">Session</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sesión de base de datos SQLAlchemy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\list_task_types_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">Session</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inicializa el caso de uso con las dependencias necesarias.</span>

<span class="sd">    Args:</span>
<span class="sd">        db (Session): Sesión de base de datos SQLAlchemy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span> <span class="o">=</span> <span class="n">CulturalPracticesRepository</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="app.cultural_practices.application.list_task_types_use_case.ListTaskTypesUseCase.list_task_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_task_types</span><span class="p">(</span><span class="n">current_user</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Lista todos los tipos de tareas de labor cultural.</p>
<p>Este método obtiene todos los tipos de tareas desde el repositorio y los mapea a
objetos de respuesta.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>current_user</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="app.user.domain.schemas.UserInDB" href="../../user/schemas/#app.user.domain.schemas.UserInDB">UserInDB</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Usuario actual autenticado que intenta acceder a los tipos de tareas.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TaskTypeListResponse</code></td>            <td>
                  <code><span title="app.cultural_practices.domain.schemas.TaskTypeListResponse">TaskTypeListResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Respuesta que contiene la lista de tipos de tareas.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>app\cultural_practices\application\list_task_types_use_case.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_task_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_user</span><span class="p">:</span> <span class="n">UserInDB</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskTypeListResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lista todos los tipos de tareas de labor cultural.</span>

<span class="sd">    Este método obtiene todos los tipos de tareas desde el repositorio y los mapea a</span>
<span class="sd">    objetos de respuesta.</span>

<span class="sd">    Args:</span>
<span class="sd">        current_user (UserInDB): Usuario actual autenticado que intenta acceder a los tipos de tareas.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TaskTypeListResponse: Respuesta que contiene la lista de tipos de tareas.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">task_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cultural_practice_repository</span><span class="o">.</span><span class="n">get_task_types</span><span class="p">()</span>
    <span class="n">task_type_responses</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_task_type_to_response</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span> <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">task_types</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">TaskTypeListResponse</span><span class="p">(</span><span class="n">task_types</span><span class="o">=</span><span class="n">task_type_responses</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>